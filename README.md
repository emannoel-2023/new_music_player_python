# SoundWave Player: M√∫sica no Terminal para Todos

Player de m√∫sica para terminal em Python, com interface din√¢mica, espectro visual, controle por comandos, playlist, hist√≥rico, monitoramento de CPU/RAM e integra√ß√£o com r√°dio online e YouTube.

## Introdu√ß√£o

No mundo digital de hoje, onde interfaces gr√°ficas complexas e softwares que demandam muitos recursos s√£o a norma, o SoundWave Player surge como uma alternativa propositalmente minimalista e eficiente. Desenvolvido em Python, este projeto visa oferecer uma experi√™ncia musical completa diretamente no terminal, priorizando a leveza, a acessibilidade e o controle direto. Este documento detalha as motiva√ß√µes por tr√°s das escolhas de design, as funcionalidades implementadas e um guia completo para colocar o player em funcionamento.

## O Porqu√™ do Terminal: Acessibilidade e Efici√™ncia

A escolha de desenvolver o SoundWave Player para o terminal n√£o foi arbitr√°ria; ela reflete uma filosofia de design focada na **efici√™ncia, estabilidade e acessibilidade**.

### 1. Desempenho e Requisitos de Hardware Reduzidos

Ambientes gr√°ficos modernos, com suas anima√ß√µes, transi√ß√µes e elementos visuais ricos, consomem uma quantidade significativa de recursos de CPU e RAM. Para usu√°rios com **hardware mais antigo ou limitado**, essa demanda pode resultar em lentid√£o, travamentos e uma experi√™ncia frustrante.

O SoundWave Player, ao operar no terminal, elimina a necessidade de renderizar uma interface gr√°fica complexa. As bibliotecas como `curses` s√£o otimizadas para manipula√ß√£o de texto em console, resultando em:

* **Menor consumo de CPU**: A aus√™ncia de uma interface gr√°fica pesada significa que o processador pode se concentrar na reprodu√ß√£o de √°udio e nas funcionalidades do player, em vez de gerenciar elementos visuais. O player inclusive monitora e exibe o uso de CPU e RAM em tempo real.
* **Menor consumo de RAM**: A mem√≥ria √© utilizada principalmente para os dados do √°udio e as estruturas de dados do programa, n√£o para texturas ou elementos visuais complexos. Isso √© crucial para m√°quinas com pouca RAM.
* **Compatibilidade ampla**: Um aplicativo de terminal tende a ser mais port√°til e a funcionar em uma gama maior de sistemas operacionais (Linux, macOS, Windows via `windows-curses`), sem a necessidade de drivers gr√°ficos espec√≠ficos ou depend√™ncias de frameworks GUI.

### 2. Estabilidade e Foco

Ambientes de terminal s√£o inerentemente mais est√°veis para certas aplica√ß√µes, pois h√° menos camadas de software entre o programa e o sistema operacional. Isso pode se traduzir em:

* **Menos bugs relacionados √† GUI**: Elimina uma grande classe de problemas comuns em aplica√ß√µes de desktop, como falhas de renderiza√ß√£o, problemas de escala ou incompatibilidade com diferentes ambientes gr√°ficos.
* **Experi√™ncia consistente**: A interface ser√° a mesma em qualquer terminal compat√≠vel, garantindo que o usu√°rio tenha sempre a mesma experi√™ncia visual e interativa.
* **Foco na funcionalidade**: Ao desviar a aten√ß√£o do design visual extravagante, o desenvolvimento pode se concentrar puramente na robustez das funcionalidades e na experi√™ncia de √°udio.

### 3. Aprendizado e Habilidade T√©cnica

Para desenvolvedores e entusiastas, a cria√ß√£o de uma aplica√ß√£o de terminal √© um excelente exerc√≠cio de programa√ß√£o de baixo n√≠vel e compreens√£o de como as interfaces de usu√°rio realmente funcionam. Tamb√©m serve como uma ferramenta "nerd-friendly" que pode ser apreciada por aqueles que preferem interagir com seus sistemas de forma mais direta.

## üöÄ Instala√ß√£o e Configura√ß√£o do Ambiente

Para executar o SoundWave Player, √© crucial preparar o ambiente com as vers√µes e programas corretos. Siga este guia detalhadamente.

### **Pr√©-requisitos**
* **Sistema Operacional:** Windows (o guia foi focado nesta plataforma), Linux, macOS
* **Terminal:** PowerShell √© recomendado para Windows
* **Git:** Para clonar o projeto
* **Python 3.11:** Vers√£o espec√≠fica necess√°ria para compatibilidade

---

### **Passo 1: Instalar Python 3.11**

O projeto **exige o Python 3.11** devido a incompatibilidades de uma de suas depend√™ncias (`pydub`) com vers√µes mais recentes.

1. Baixe o instalador do Python 3.11.9 aqui: **[Python 3.11.9 para Windows](https://www.python.org/downloads/release/python-3119/)**
2. Execute o instalador. Na primeira tela, **marque a caixa "Add python.exe to PATH"**. Esta etapa √© fundamental.
3. Prossiga com a instala√ß√£o padr√£o.

### **Passo 2: Instalar FFmpeg e MPV**

Estas ferramentas externas s√£o **obrigat√≥rias** para o funcionamento completo.

1. **FFmpeg:** (Necess√°rio para `pydub` processar √°udios)
   - Baixe a vers√£o "release-full" em: [https://www.gyan.dev/ffmpeg/builds/](https://www.gyan.dev/ffmpeg/builds/)
   - Extraia para uma pasta permanente (ex: `C:\ffmpeg`)
   - Adicione a subpasta `bin` ao PATH do Windows (ex: `C:\ffmpeg\bin`)

2. **MPV:** (Necess√°rio para a reprodu√ß√£o do YouTube e R√°dio)
   - Baixe o MPV em: [https://mpv.io/installation/](https://mpv.io/installation/)
   - Extraia para uma pasta permanente (ex: `C:\mpv`)
   - Adicione esta pasta ao PATH do Windows (ex: `C:\mpv`)

> **Como adicionar ao PATH:** Pressione `Win`, digite "vari√°veis de ambiente", clique em "Editar as vari√°veis de ambiente do sistema" -> "Vari√°veis de Ambiente...", selecione "Path" na lista de baixo e clique em "Editar". Adicione uma nova entrada para cada caminho.

### **Passo 3: Clonar e Preparar o Projeto**

1. Abra um terminal (PowerShell) e clone o reposit√≥rio
2. Crie o ambiente virtual usando o **Python 3.11**:
```powershell
# Cria o ambiente virtual na pasta .venv
py -3.11 -m venv .venv
```

3. **Habilite a execu√ß√£o de scripts no PowerShell** (s√≥ precisa ser feito uma vez):
```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```
Pressione `S` e `Enter` para confirmar.

4. **Ative o ambiente virtual:**
```powershell
.\.venv\Scripts\activate
```
Seu prompt dever√° mostrar `(.venv)` no in√≠cio.

5. **Instale todas as depend√™ncias Python:**
```powershell
pip install -r requirements.txt
```

## üèÉ Como Executar

Com o ambiente configurado e ativado (`(.venv)` vis√≠vel no prompt), inicie o programa:

```bash
python main.py
```

## ‚å®Ô∏è Comandos e Atalhos

A interface √© controlada inteiramente pelo teclado.

| Tecla(s) | A√ß√£o |
|----------|------|
| 1 | Abrir um diret√≥rio (colar caminho) |
| 2 / Enter | Tocar / Pausar a m√∫sica selecionada |
| 3 | M√∫sica Anterior |
| 4 | Pr√≥xima M√∫sica |
| ‚Üë ‚Üì ‚Üê ‚Üí | Navegar na lista de m√∫sicas |
| + / = | Aumentar Volume |
| - | Diminuir Volume |
| i | Abrir o Navegador de Arquivos |
| b | Buscar m√∫sicas na biblioteca |
| t | Filtrar biblioteca por categoria |
| s | Saltar para uma m√∫sica pelo n√∫mero |
| o | Ordenar a playlist atual |
| l | Listar e carregar playlists salvas |
| c | Criar uma nova playlist |
| a | Adicionar m√∫sica atual a uma playlist |
| d | Remover m√∫sica de uma playlist |
| f | Favoritar / Desfavoritar m√∫sica |
| h | Ver hist√≥rico de reprodu√ß√£o |
| e | Abrir controles de Equaliza√ß√£o (EQ) |
| x | Mostrar tela de Estat√≠sticas |
| y | Abrir modo de reprodu√ß√£o do YouTube |
| r | Abrir modo R√°dio |
| q | Sair do programa |

### Comandos de Texto Tradicionais

Voc√™ tamb√©m pode usar comandos de texto digitando no prompt inferior:

- `play` ou `p`: tocar/pausar m√∫sica
- `pause`: pausar m√∫sica
- `stop`: parar m√∫sica
- `prox` ou `next`: pr√≥xima m√∫sica
- `ant` ou `prev`: m√∫sica anterior
- `vol <valor>`: definir volume (0.0 a 1.0)
- `dir`: carregar diret√≥rio de m√∫sicas (cole o caminho)
- `radio`: abrir aplicativo de r√°dio integrado
- `sair`: fechar player

## üéµ Funcionalidades

### Player de M√∫sica
- Reprodu√ß√£o de arquivos de √°udio locais
- Controle de volume e navega√ß√£o
- Espectro visual em tempo real
- Suporte a m√∫ltiplos formatos de √°udio (mp3, wav, flac, ogg, m4a)
- Equalizador de √°udio (grave, m√©dio, agudo)

### üìª Integra√ß√£o com R√°dio
- Acesso ao aplicativo de r√°dio terminal integrado
- Pausa autom√°tica da m√∫sica ao abrir o r√°dio
- Retomada autom√°tica ao fechar o r√°dio
- Interface seamless entre os dois modos

### üé¨ Integra√ß√£o com YouTube
- Reprodu√ß√£o de v√≠deos do YouTube (apenas √°udio)
- Busca e sele√ß√£o de v√≠deos
- Controle integrado com a interface principal

### üìä Monitoramento
- Monitoramento de CPU e RAM do processo
- Exibi√ß√£o de informa√ß√µes do sistema em tempo real

### üìù Gerenciamento
- Sistema de playlists e favoritos (persistidos diretamente por playlist.py)
- Hist√≥rico de m√∫sicas reproduzidas (persistido diretamente por historico.py)
- Persist√™ncia de dados entre sess√µes
- Biblioteca de m√∫sicas com busca e filtragem por metadados (artista, √°lbum, g√™nero, t√≠tulo)
- Ordena√ß√£o de playlists por diversos crit√©rios

## Escolhas de Arquitetura e Implementa√ß√£o

O SoundWave Player √© constru√≠do sobre uma arquitetura modular, onde cada componente tem uma responsabilidade bem definida. Isso facilita a manuten√ß√£o, a adi√ß√£o de novas funcionalidades e a compreens√£o do c√≥digo.

### 1. Reprodu√ß√£o de √Åudio (`audio.py`)

* **`pygame.mixer`**: A escolha de `pygame.mixer` para a reprodu√ß√£o de √°udio se deve √† sua simplicidade e efici√™ncia para tocar arquivos de m√∫sica. Embora `pygame` seja conhecido por desenvolvimento de jogos, seu m√≥dulo de mixer √© leve e perform√°tico para √°udio, suportando diversos formatos como MP3, WAV, FLAC e OGG.
* **Espectro Visual (`numpy`, `pydub`)**: A gera√ß√£o do espectro visual √© uma funcionalidade que enriquece a experi√™ncia no terminal.
    * `pydub` √© utilizada para carregar segmentos de √°udio e extrair os dados de amostra brutos, que s√£o ent√£o processados.
    * `numpy` √© fundamental para realizar a Transformada R√°pida de Fourier (FFT), convertendo os dados de tempo para o dom√≠nio da frequ√™ncia, permitindo a visualiza√ß√£o das barras do espectro. A suaviza√ß√£o das barras e a normaliza√ß√£o do espectro din√¢mico garantem uma visualiza√ß√£o fluida e adapt√°vel.
* **`mutagen`**: A biblioteca `mutagen` √© empregada para extrair metadados como dura√ß√£o, artista, √°lbum, g√™nero e t√≠tulo dos arquivos de √°udio. Isso garante que o player possa exibir informa√ß√µes detalhadas sobre a m√∫sica atual e organizar a biblioteca.
* **Processamento em Thread**: O n√∫cleo de √°udio opera em sua pr√≥pria thread, usando uma fila (`queue`) para receber comandos. Isso garante que a interface do usu√°rio permane√ßa sempre fluida e responsiva.

### 2. Interface de Usu√°rio (`src/ui/`)

A pasta `src/ui` cont√©m a l√≥gica para a interface de usu√°rio baseada em `curses`.

* **`ui_core.py`**: √â o cora√ß√£o da interface. Ele orquestra a intera√ß√£o entre o player de √°udio, o gerenciador de playlists, o hist√≥rico e os componentes visuais. O uso do padr√£o Observer para a comunica√ß√£o entre o `AudioPlayer` e a `UIPlayer` (atrav√©s do m√©todo `atualizar`) permite que a UI reaja a eventos do player, como mudan√ßa de volume ou fim de m√∫sica, de forma desacoplada.
* **`ui_components.py`**: Este m√≥dulo √© respons√°vel por desenhar os elementos individuais da interface, como bordas, t√≠tulo (`pyfiglet`), espectro, barra de volume, status da m√∫sica e o menu inferior. A separa√ß√£o dos componentes de desenho torna o c√≥digo mais limpo e reutiliz√°vel.
* **`ui_utils.py`**: Cont√©m fun√ß√µes auxiliares como a inicializa√ß√£o das cores `curses` e o formato de tempo. A fun√ß√£o `uso_recursos` (que utiliza `psutil`) foi realocada para c√° para centralizar as utilidades de UI.

### 3. Gerenciamento de Conte√∫do e Dados

* **`playlist.py`**: Permite criar, adicionar, remover e ordenar playlists. Ele tamb√©m √© respons√°vel por carregar e salvar o estado das playlists e a lista de favoritos em um arquivo `json` na pasta `data/` do projeto.
* **`historico.py`**: Mant√©m um registro das m√∫sicas reproduzidas, oferecendo funcionalidades como `adicionar`, `anterior` e `estatisticas` (para as m√∫sicas mais tocadas). A persist√™ncia √© gerenciada diretamente pelo pr√≥prio m√≥dulo, salvando em um arquivo `json` na pasta `data/`.
* **`biblioteca.py`**: Gerencia a cole√ß√£o de m√∫sicas do usu√°rio, permitindo carregar diret√≥rios, listar m√∫sicas por artista, √°lbum ou g√™nero, e realizar buscas. A implementa√ß√£o de uma **√Årvore Bin√°ria de Busca** (`ArvoreMusicas`) para t√≠tulos demonstra uma preocupa√ß√£o com a efici√™ncia na busca em grandes cole√ß√µes.
* **`config_manager.py`**: Respons√°vel por salvar e carregar configura√ß√µes do usu√°rio, como o volume e as prefer√™ncias de equaliza√ß√£o. Este m√≥dulo persiste suas configura√ß√µes em um arquivo oculto no diret√≥rio home (`~/.musga_config.json`), n√£o na pasta `data/` do projeto, garantindo que as configura√ß√µes sejam mantidas entre as sess√µes.
* **`constants.py`**: Este arquivo na raiz do projeto centraliza a defini√ß√£o de caminhos importantes, como `PASTA_DADOS`, evitando duplica√ß√µes de c√≥digo e garantindo que todos os m√≥dulos acessem o mesmo local para persist√™ncia de dados.

### 4. Integra√ß√£o com Ferramentas Externas

* **R√°dio e YouTube (`radio_terminal/`, `youtube_integration.py`)**: A inclus√£o de m√≥dulos separados para r√°dio e YouTube amplia a funcionalidade. Eles s√£o executados como subprocessos, permitindo que o player principal pause a m√∫sica, entregue o controle e retome a reprodu√ß√£o automaticamente ao final. A comunica√ß√£o com `mpv` √© um exemplo de como orquestrar ferramentas externas poderosas.
* **`MPVIPCClient`**: Esta classe permite a comunica√ß√£o com o MPV (um player de m√≠dia leve e de c√≥digo aberto) via IPC (Inter-Process Communication). Isso √© crucial para o r√°dio poder controlar o MPV e obter metadados das esta√ß√µes, como o t√≠tulo da m√∫sica sendo transmitida.
* **Monitoramento de Rede**: O `NetworkMonitor` dentro do m√≥dulo de r√°dio demonstra uma preocupa√ß√£o com a experi√™ncia do usu√°rio, exibindo o uso de rede em tempo real para streams de r√°dio.

## üìÅ Estrutura do Projeto

```
soundwave/
‚îÇ
‚îú‚îÄ‚îÄ .venv/                 # Pasta do ambiente virtual Python
‚îú‚îÄ‚îÄ constants.py           # Define PASTA_DADOS e outras constantes globais
‚îú‚îÄ‚îÄ data/                  # Armazena estado_player.json, favoritos.json, historico.json
‚îÇ   ‚îú‚îÄ‚îÄ estado_player.json # Estado do player e playlists salvas
‚îÇ   ‚îú‚îÄ‚îÄ favoritos.json     # Lista de favoritos
‚îÇ   ‚îî‚îÄ‚îÄ historico.json     # Hist√≥rico de reprodu√ß√£o
‚îú‚îÄ‚îÄ radio_terminal(bonus)/ # M√≥dulo b√¥nus para r√°dio online
‚îÇ   ‚îú‚îÄ‚îÄ radio.py           # Aplicativo de r√°dio integrado
‚îÇ   ‚îî‚îÄ‚îÄ ...                # Outros arquivos do r√°dio (e.g., radios.txt)
‚îú‚îÄ‚îÄ src/                   # Cont√©m todo o c√≥digo-fonte principal
‚îÇ   ‚îú‚îÄ‚îÄ __pycache__/
‚îÇ   ‚îú‚îÄ‚îÄ ui/                # M√≥dulos da interface do usu√°rio (curses)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __pycache__/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui_components.py # Componentes visuais da UI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui_core.py       # L√≥gica principal da UI e intera√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui_utils.py      # Fun√ß√µes utilit√°rias da UI (inicia cores, uso_recursos)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ audio.py           # Player de √°udio e espectro
‚îÇ   ‚îú‚îÄ‚îÄ biblioteca.py      # Gerenciamento da biblioteca musical
‚îÇ   ‚îú‚îÄ‚îÄ comandos.py        # Interpreta√ß√£o e execu√ß√£o de comandos
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py  # Gerenciamento de configura√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ historico.py       # Hist√≥rico de m√∫sicas tocadas (com persist√™ncia pr√≥pria)
‚îÇ   ‚îú‚îÄ‚îÄ playlist.py        # Gerenciamento de playlists e favoritos (com persist√™ncia pr√≥pria)
‚îÇ   ‚îú‚îÄ‚îÄ recursos.py        # Monitoramento CPU/RAM do processo (deprecated, use ui_utils)
‚îÇ   ‚îú‚îÄ‚îÄ utils.py           # Fun√ß√µes auxiliares (como formatar_tempo)
‚îÇ   ‚îî‚îÄ‚îÄ youtube_integration.py # Integra√ß√£o com YouTube
‚îú‚îÄ‚îÄ testes/                # Testes unit√°rios
‚îÇ   ‚îú‚îÄ‚îÄ test_audio.py
‚îÇ   ‚îú‚îÄ‚îÄ test_biblioteca.py
‚îÇ   ‚îî‚îÄ‚îÄ test_playlist.py
‚îú‚îÄ‚îÄ main.py                # Arquivo principal para iniciar o player
‚îú‚îÄ‚îÄ requirements.txt       # Depend√™ncias do projeto
‚îî‚îÄ‚îÄ README.md              # Este arquivo
```

## Integra√ß√£o com R√°dio e YouTube

### R√°dio Online
O SoundWave Player inclui integra√ß√£o com um aplicativo de r√°dio terminal. Quando o comando `radio` ou tecla `r` √© executado:

- A m√∫sica atual √© pausada automaticamente (se estiver tocando)
- O aplicativo de r√°dio √© aberto em uma nova janela
- Ao fechar o r√°dio, a interface do player √© restaurada
- A m√∫sica √© retomada automaticamente (se estava tocando antes)

### YouTube
A integra√ß√£o com YouTube permite:

- Buscar e reproduzir v√≠deos do YouTube (apenas √°udio)
- Interface integrada para sele√ß√£o de v√≠deos
- Controle seamless entre m√∫sica local e YouTube

## üß™ Testes

Para rodar os testes unit√°rios e garantir a integridade dos m√≥dulos:

```bash
python -m unittest discover testes
```

## üì¶ Depend√™ncias

O projeto utiliza as seguintes bibliotecas externas:

### Depend√™ncias Principais
- **pygame**: Para reprodu√ß√£o de √°udio
- **numpy**: Para processamento de espectro
- **psutil**: Para monitoramento do sistema (CPU/RAM)
- **windows-curses**: Para compatibilidade do curses no Windows
- **pyfiglet**: Para texto ASCII art (t√≠tulo)
- **requests**: Para requisi√ß√µes HTTP (r√°dio online)
- **pydub**: Para manipula√ß√£o de segmentos de √°udio (espectro, equaliza√ß√£o)
- **mutagen**: Para extra√ß√£o de metadados de arquivos de √°udio (dura√ß√£o, artista, t√≠tulo, etc.)
- **yt-dlp**: Para obter informa√ß√µes de v√≠deos do YouTube
- **pywin32**: Para funcionalidades de IPC no Windows

## Conclus√£o

O SoundWave Player √© mais do que apenas um tocador de m√∫sica no terminal; √© um projeto que abra√ßa a filosofia de "fazer mais com menos". 
Suas escolhas de design, desde a interface de texto at√© a modularidade do c√≥digo e a integra√ß√£o com ferramentas eficientes como `pygame.mixer` e `mpv`,
visam proporcionar uma experi√™ncia musical acess√≠vel e robusta, especialmente para aqueles com recursos de hardware limitados. Ele prova que n√£o √© preciso
 uma interface complexa para desfrutar plenamente da sua biblioteca musical e do mundo do r√°dio online e YouTube.